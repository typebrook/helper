# Connection options
set ssl_force_tls = yes
unset ssl_starttls

# Default settings
set header_cache = ~/.cache/mutt
set message_cachedir = ~/.cache/mutt
set edit_headers=yes
set mailcap_path = ~/.config/mutt/mailcap

# Interface
set editor = "vim"
set charset = "utf-8"
set send_charset = "us-ascii:utf-8"
set header = no
set pager_stop
set sleep_time = 0 # When changing folder
set timeout = 10
set quit = ask-no
set sort = reverse-threads
set pager_index_lines = 5
set markers = no # Remove '+' for long links with limited terminal width
set index_format = "%4C %8Y %Z %(%b %d) %-15.15L (%?l?%4l&%4c?) %s"

# Preference
alternative_order text/plain text/enriched text/html 
# Auto convert text/html MIME type to text/plain
auto_view text/html
# Macro to open html with css
#macro index,pager h "<pipe-message>htmail-decode<return>" "render html mail using htmail-view"

# Vim-style key binding, \c means Ctrl
# ref: https://fancyseeker.github.io/2015/08/19/mutt/#vim风格键位绑定
bind index <Return> sync-mailbox
bind index q browse-mailboxes
bind index y edit-label
bind index x tag-entry
bind index t edit-label
bind index,browser l select-entry
bind index \\ limit
bind index \cj next-entry
bind index \ck previous-entry
bind index,browser G last-entry
bind index,browser g noop
bind index,browser gg first-entry
bind index \cf next-page
bind index \cb previous-page
bind index \cd half-down
bind index \cu half-up
bind index } bottom-page
bind pager G bottom
bind pager g noop
bind pager gg top
bind pager j next-line
bind pager k previous-line
bind pager \cf next-page
bind pager \cb previous-page
bind pager \cd half-down
bind pager \cu half-up
bind pager \cj next-entry
bind pager \ck previous-entry
bind pager \ch display-toggle-weed
bind attach x view-mailcap
macro generic,index,pager \cr ":source ~/.config/mutt/muttrc\n" "Reload mutt's configuration file"
macro index <Return> ":exec sync-mailbox\n" "Sync Mailbox"
macro index *a "Tall\n" "Select All"
macro index *n "\ctall\n" "Deselect All"
macro index h "\\all\n" "All messages"
macro index d '<tag-prefix><delete-message>' 'Delete'
macro index s '<tag-prefix><save-message>' 'Saved'

# Sidebar
set mail_check = 120
set mail_check_stats
set imap_check_subscribed
set sidebar_visible = yes
set sidebar_format = '%B%?F? [%F]?%* %?N?%N/?%S'
set sidebar_short_path = yes
set sidebar_width = 20
bind index,pager B sidebar-toggle-visible
bind index \Cp sidebar-prev
bind index \Cn sidebar-next
bind index,pager \Co sidebar-open
bind index,pager <F5> sidebar-prev-new
bind index,pager <F6> sidebar-next-new
color indicator cyan black
color sidebar_highlight white color8
color sidebar_divider color8 black
color sidebar_flagged red black
color sidebar_new green black

# basic colors
color normal        white           black
color error         red             black
color tilde         white           black
color message       cyan            black
color markers       red             black
color attachment    brightred       black
color search        brightmagenta   black
color status        brightwhite     black
color indicator     white           blue
color tree          magenta         black   # arrows in threads

# For list
# Highlight mails by their status. For a specific pattern(e.g. ~N), pleas read mutt manual 4.2
color index         red             black         "~A"                        # all messages
color index         brightred       black         "~E"                        # expired messages
color index         brightcyan      black         "~N"                        # new messages
color index         brightcyan      black         "~O"                        # old messages
color index         brightmagenta   black         "~Q"                        # messages that have been replied to
color index         white           black         "~R"                        # read messages
color index         brightblue      black         "~U"                        # unread messages
color index         brightblue      black         "~U~$"                      # unread, unreferenced messages
color index         brightblue      black         "~v"                        # messages part of a collapsed thread
color index         brightblue      black         "~P"                        # messages from me
color index         cyan            black         "~p!~F"                     # messages to me
color index         brightgreen     black         "~N~p!~F"                   # new messages to me
color index         brightgreen     black         "~U~p!~F"                   # unread messages to me
color index         brightgreen     black         "~R~p!~F"                   # messages to me
color index         red             black         "~F"                        # flagged messages
color index         red             black         "~F~p"                      # flagged messages to me
color index         red             black         "~N~F"                      # new flagged messages
color index         red             black         "~N~F~p"                    # new flagged messages to me
color index         red             black         "~U~F~p"                    # new flagged messages to me
color index         brightyellow    black         "~T"                        # tagged messages
color index         black           brightmagenta "~D"                        # deleted messages
color index         white           black         "~v~(!~N!~O)"               # collapsed thread with no unread
color index         magenta         black         "~v~(~N|~O)"                # collapsed thread with some unread
color index         magenta         black         "~N~v~(~N)"                 # collapsed thread with unread parent
color index         red             white         "~v~(~F)!~N"                # collapsed thread with flagged, no unread
color index         yellow          white         "~v~(~F~N)"                 # collapsed thread with some unread & flagged
color index         green           white         "~N~v~(~F~N)"               # collapsed thread with unread parent & flagged
color index         green           white         "~N~v~(~F)"                 # collapsed thread with unread parent, no unread inside, but some flagged
color index         yellow          red           "~v~(~D)"                   # thread with deleted (doesn't differentiate between all or partial)

# color header
color header        green           black         "^(From)"
color header        brightyellow    black         "^(Subject)"

# Set quote's starting symbol
set quote_regexp = "^([ ]t]*[|>:}#])+"
set quote_regexp = "^([ \t ]*[>])+"

# Highlight quotes by indent
color quoted        blue            black
color quoted1       magenta         black
color quoted2       cyan            black
color quoted3       yellow          black
color quoted4       red             black

# urls
color body       brightblue    black "(^|<| )mailto:[^ ]+@[^ ]( |>|$)"
color body       brightblue    black "(^|<| )(http|https|ftp|file|telnet|news|finger)://[^ ]+( |>|$)"

# *bold*, _underline_, and /italic/
color body       brightcyan    black "(^| )\\*[^ ]+\\*( |$)"
color body       brightcyan    black "(^| )_[^ ]+_( |$)"
color body       brightcyan    black "(^| )/[^ ]+/( |$)"
